#!/usr/bin/env sh
#
# DESCRIPTION:
#   Execute magic's desktop :)
#
# Executed by startx (run your window manager from here)

#-------------------------------------------------------------------------------
# Environment Variables
#-------------------------------------------------------------------------------

export NO_AT_BRIDGE=1 \
       LIMIT_WALLPAPERS=50 \
       TRASH="$HOME/.local/trash" \
       XWALLPAPERS_FOLDER="$HOME/Images/wallpapers" \
       XWALLPAPER_HISTORY="$HOME/Base/xwallpapers_history" \
       XNOTIFY_FIFO="$HOME/.cache/xnotify.fifo" \
       NOTMUCH_CONFIG="$HOME/.config/nt/" \
       PASSWORD_STORE_DIR="$HOME/.config/nt" \
       PARU_CONF="$HOME/.config/paru/paru.conf" \
       XDG_CONFIG_HOME="$HOME/.config/" \
       EDITOR="nvim" "VISUAL=nvim" \
       BROWSER='firefox' \
       XDG_CONFIG_HOME="$HOME/.config" \
       GNUPGHOME="${XDG_CONFIG_HOME}/gnupg" \
       CARGO_HOME="${XDG_CONFIG_HOME}/cargo" \
       READER='zathura' \
       FILE='nnn' \
       EDITOR='nvim' \
       VISUAL='nvim' \
       GTK2_RC_FILES="$HOME/.config/gtk-2.0/gtkrc-2.0" \
       ZDOTDIR="$HOME/.config/zsh" \
       LESSHISTFILE='/dev/null' \
       PATH="$HOME/.config/.cargo/bin:$HOME/git/scripts/colour:$HOME/git/scripts/mpd:$HOME/git/scripts/quotes:$HOME/git/scripts/root:$HOME/git/scripts/screenshot:$HOME/.local/bin:$PATH"


#-------------------------------------------------------------------------------
# Start shit (Important session)
#-------------------------------------------------------------------------------

#   Start keyboard manager
dwm &

#   Japanese Keyboard
/usr/bin/fcitx5 &

# Choose wallpaper with FEH
feh --no-fehbg --bg-scale "$(tail -n1 ~/Base/xwallpapers_history)"

# Picom as compositor
picom --experimental-backends --blur-method dual_kawase --blur-strength 3 &

#-------------------------------------------------------------------------------
# Start shit (Not so important session)
#-------------------------------------------------------------------------------

#  Notifications per tag change
xnotify -o 0<>"$XNOTIFY_FIFO" &

#   Start xbindkeys for keybinds
xbindkeys -f "$HOME/Base/xbindkeysrc" &

#   Start MPD and MPD Scrible to Lastfm and Music
mpd "$HOME/.config/mpd/mpd.conf" &
mpdscribble --conf "$HOME/.config/mpdscribble/mpdscribble.conf" &

#   Set Keyboard speed typing
xset r rate 170 60 & 

#   Set Mouse speed
xinput --set-prop 12 310 -0.75 &

#   Set Left Handed Mouse
xmodmap -e 'pointer = 3 2 1' &

#   Start unclutter to make mouse disappear after one second
unclutter --timeout 1 &

#   Open new terminal and todoncli7
st -g 76x30+830+57 -t 'todoncli' -e 'dash' '-c' 'cd ~/git/tdtd && node todoncli.js' &

#   Start SSH-AGENT
eval $(ssh-agent) &

#   Set Keyboard to Portuguese ABNT 2 (I know it shouldn't be here, but whatever)
setxkbmap -model abnt2 -layout br -variant abnt2 &

#   Start Lemonbar (bottom and top bars)
$HOME/git/scripts/bars/bars &

#   Sleep after 12 minutes of inactivity
xautolock -time 7 -locker "lock"
